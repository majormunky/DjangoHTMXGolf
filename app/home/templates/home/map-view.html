{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div id="map"></div>
    </div>
</div>
{% endblock %}

{% block page_scripts %}
<script src="https://cdn.apple-mapkit.com/mk/5.x.x/mapkit.core.js"
        crossorigin async
        data-callback="initMapKit"
        data-libraries="services,full-map,geojson,annotations"
        data-initial-token="eyJraWQiOiI5NzVYR1dHVFM1IiwidHlwIjoiSldUIiwiYWxnIjoiRVMyNTYifQ.eyJpc3MiOiI4MktYNzhUTjI1IiwiaWF0IjoxNzE5MDA5MTgwLCJvcmlnaW4iOiIqLmpvc2hicmlnaHQuZGV2In0.Jv21WmuZnF4JF79eK_YfBB1NEvSyhn38A2eQDWj8Z2XLQXwCZ7RDPGsyRNoLurHHN1OP-D8y7S-mkXnqdUafLQ"
></script>

<script>
 async function getMapKitAsync() {
     if (!window.mapkit || window.mapkit.loadedLibraries.length === 0) {
         await new Promise(resolve => { window.initMapKit = resolve });
         delete window.initMapKit;
     }
     return window.mapkit;
 }

 document.addEventListener("DOMContentLoaded", async () => {
     const mapkit = await getMapKitAsync();
     const map = new mapkit.Map("map");

     mapkit.addEventListener("load", event => {
         console.log("Load event fired");
     });
 });
</script>
{% endblock %}
