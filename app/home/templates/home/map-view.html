{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div id="map"></div>
    </div>
</div>
{% endblock %}

{% block page_scripts %}
<script
    src="https://cdn.apple-mapkit.com/mk/5.x.x/mapkit.core.js"
    crossorigin async
    data-callback="initMapKit"
    data-libraries="map"
    data-initial-token="eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6Ikw2NjU2VTVGQTQifQ.eyJpc3MiOiI4MktYNzhUTjI1IiwiaWF0IjoxNzE5MjQzNzE5LCJleHAiOjE3MzU2MDMyMDAsIm9yaWdpbiI6Imh0dHBzOi8vZ29sZi5qb3NoYnJpZ2h0LmRldiJ9.kBJPZ9ROPmnKagF8zuRJr41eU5ZnqK1a8weHX4IcQk2hZG63uE14oElviuWQuek8fUqgPDSAsWBmsJp1LeDegQ"
></script>
<script type="module">

 (async () => {
     const tokenID = "eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6Ikw2NjU2VTVGQTQifQ.eyJpc3MiOiI4MktYNzhUTjI1IiwiaWF0IjoxNzE5MjQzNzE5LCJleHAiOjE3MzU2MDMyMDAsIm9yaWdpbiI6Imh0dHBzOi8vZ29sZi5qb3NoYnJpZ2h0LmRldiJ9.kBJPZ9ROPmnKagF8zuRJr41eU5ZnqK1a8weHX4IcQk2hZG63uE14oElviuWQuek8fUqgPDSAsWBmsJp1LeDegQ";

     if (!window.mapkit || window.mapkit.loadedLibraries.length === 0) {
         // mapkit.core.js or the libraries are not loaded yet.
         // Set up the callback and wait for it to be called.
         await new Promise(resolve => { window.initMapKit = resolve });

         // Clean up
         delete window.initMapKit;
     }

     mapkit.init({
         authorizationCallback: function(done) {
             done(tokenID);
         }
     });

     const map = new mapkit.Map("map");
 })();

</script>
{% endblock %}

{% block styles %}
<style>
 #map {
     width: 100%;
     height: 600px;
 }
</style>
{% endblock %}
